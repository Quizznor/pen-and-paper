% TYPESETTING WORKFLOW

\newcommand{\then}{$\rightarrow\;$}
\newcommand{\page}[1]{\textcolor{OrangeBoxFrame}{\pageref{#1}}}
\newcommand{\charakter}[1]{\textcolor{violet}{\textbf{\gls{#1}}}}
\newcommand{\getdiff}[1]{%
\ifthenelse{\equal{#1}{}}{}{%
\ifthenelse{#1<0}{(#1)}{(#1)}}}

% COLORS

\definecolor{RedBoxFrame}{RGB}{157,16, 45}
\definecolor{BlueBoxFrame}{RGB}{0,70,202}
\definecolor{OrangeBoxFrame}{RGB}{255,103,0}
\definecolor{BrownBoxFrame}{RGB}{110,44,0}


% INFO

\newtcolorbox{infobox}[1][]{
lower separated=false,
colback=white,
colframe=OrangeBoxFrame,
fonttitle=\bfseries,
colbacktitle=OrangeBoxFrame,
coltitle=white,
enhanced,
frame hidden,
borderline={1.5pt}{0pt}{OrangeBoxFrame,dashed},
attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
boxed title style={boxrule=0pt,colframe=white,},
title=Information für Spielleiter}

\newenvironment{info-box}[1]{%
\begin{infobox}{#1}\vspace{6pt}}
{\end{infobox}\vspace{1em}}


% REFERENCES

\newtcolorbox{refbox}[2][]{
lower separated=false,
colback=white,
frame hidden,
borderline={1.5pt}{0pt}{OrangeBoxFrame,dashed},
colframe=OrangeBoxFrame,
fonttitle=\bfseries,
colbacktitle=OrangeBoxFrame,
coltitle=white,
enhanced,
attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
boxed title style={boxrule=0pt,colframe=white,},
title=Plot Ende für #2}

\newenvironment{ref-box}[2]{%
\begin{refbox}{#1}{\vspace{1em}#2}}
{\vspace{5pt}\end{refbox}\vspace{1em}}


% DESCRIPTIONS

\newtcolorbox{placebox}[2][]{
lower separated=false,
colback=white,
colframe=BrownBoxFrame,
fonttitle=\bfseries,
colbacktitle=BrownBoxFrame,
coltitle=white,
enhanced,
attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
boxed title style={boxrule=0pt,colframe=white,},
title=Ortsbeschreibung #2}

\newenvironment{place-box}[2]{%
\begin{placebox}{#1}{#2}\vspace{6pt}}
{\end{placebox}\vspace{1em}}


% CHARACTERS

\newtcolorbox{charbox}[2][]{
lower separated=false,
colback=white,
colframe=violet,
fonttitle=\bfseries,
colbacktitle=violet,
coltitle=white,
enhanced,
frame hidden,
borderline={1.5pt}{0pt}{violet,dashed},
attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
boxed title style={boxrule=0pt,colframe=white,},
title=#2}

\newenvironment{char-box}[2]{%
\begin{charbox}{#1}{#2}}
{\end{charbox}}


% ACTIONS

\newtcolorbox{probebox}[3][]{
lower separated=false,
colback=white,
colframe=RedBoxFrame,
fonttitle=\bfseries,
colbacktitle=RedBoxFrame,
coltitle=white,
enhanced,
attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
boxed title style={boxrule=0pt,colframe=white,},
title=Probe auf #2 o.Ä. \ifthenelse{\equal{#3}{}}{}{%
\ifthenelse{#3<0}{($#3$)}{($+#3$)}}}

\newenvironment{probe-box}[2]{%
\begin{probebox}{#1}{#2}\vspace{6pt}}
{\end{probebox}\vspace{1em}}

% SPEECH

\newtcolorbox{saybox}[2][]{
lower separated=false,
colback=white,
colframe=BlueBoxFrame,
fonttitle=\bfseries,
colbacktitle=BlueBoxFrame,
coltitle=white,
enhanced,
attach boxed title to top left={yshift=-0.1in,xshift=0.15in},
boxed title style={boxrule=0pt,colframe=white,},
title= #2: }

\newenvironment{say-box}[2]{%
\begin{saybox}{#1}{#2}\vspace{6pt}}
{\end{saybox}\vspace{1em}}



% TITLEPAGE STUFF

\newcommand{\todo}[1]{\stepcounter{todocounter}{\color{blue}\textsuperscript{[to do: #1]}}}
\newcommand{\rephrase}[1]{\stepcounter{todocounter}{\color{blue}#1\textsuperscript{\color{blue}[rephrase]}}}

% storypage quote
\makeatletter
\def\advquote{%
    \@ifnextchar[{\advquote@i}{\advquote@i[]}%]
           }%
\def\advquote@i[#1]{%
    \def\tempa{#1}%
    \@ifnextchar[{\advquote@ii}{\advquote@ii[]}%]
                 }%
\def\advquote@ii[#1]{%
    \def\tempb{#1}%
    \@ifnextchar[{\advquote@iii}{\advquote@iii[]}%]
                      }%
\def\advquote@iii[#1]{%
    \def\tempc{#1}%
    \vspace{1em}%
    \noindent%
    \begin{list}{}{%
         \setlength{\leftmargin}{0.1\textwidth}%
         \setlength{\rightmargin}{0.1\textwidth}%
                  }%
         \item[]%
         \begin{picture}(0,0)%
         \put(-15,-5){\makebox(0,0){\scalebox{5}{\textcolor{RoyalRed}{``}}}}%
         \end{picture}%
         \begingroup\itshape}%

 \def\endadvquote{%
 \endgroup\par%
 \makebox[0pt][l]{%
 \hspace{0.8\textwidth}%
 \begin{picture}(0,0)(0,0)%
 \put(\quotelength,5){\makebox(0,0){%
 \scalebox{5}{\color{RoyalRed}''}}}%
 \end{picture}}%

 \ifx\tempa\empty%
 \else%
    \ifx\tempc\empty%
       \hfill\\\mbox{}\hfill\vspace{0mm}\tempa \emph{\tempb}%
   \else%
       \hfill\\\mbox{}\hfill\vspace{0mm}\tempa \emph{\tempb}\ \tempc%
   \fi\fi\par%
   \vspace{0.5em}%
 \end{list}%
 }%
 \makeatother
